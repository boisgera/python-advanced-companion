<script>
    // TODO: replace with clickable ðŸ“–, store inside (invis) the content ?
    document.addEventListener("DOMContentLoaded", (event) => {
        let collapse = document.querySelectorAll(".collapse")
        for (let elt of collapse) {
            let wrapper = document.createElement("div");
            let clone = elt.cloneNode(true);
            wrapper.appendChild(clone);
            elt.replaceWith(wrapper);

            wrapper.style.setProperty("height", "4.5em");
            wrapper.style.setProperty("overflow", "hidden");
            wrapper.style.setProperty("position", "relative");
            wrapper.style.setProperty("box-shadow", "rgba(0, 0, 0, 0) 0px 0px 0px 0px, rgba(0, 0, 0, 0) 0px 0px 0px 0px, rgba(0, 0, 0, 0.1) 0px 4px 6px -1px, rgba(0, 0, 0, 0.1) 0px 2px 4px -2px")


            let overlay = document.createElement("div");
            wrapper.appendChild(overlay);
            overlay.style.setProperty("z-index", "10");
            overlay.style.setProperty("background-color", "#f8f9fa"); // "#fff5f5");
            overlay.style.setProperty("position", "absolute");
            overlay.style.setProperty("top", "0px");
            overlay.style.setProperty("left", "0px");
            overlay.style.setProperty("bottom", "0px");
            overlay.style.setProperty("right", "0px");
            
            let icon = document.createElement("img");
            let button = document.createElement("button");
            button.appendChild(icon);
            button.style.setProperty("border", "none");
            button.style.setProperty("background", "none");
            overlay.appendChild(button);
            icon.setAttribute("src", "icons/chevron-down.svg");
            overlay.style.setProperty("display", "flex");
            overlay.style.setProperty("align-items", "center");
            overlay.style.setProperty("justify-content", "center");
            overlay.style.setProperty("box-shadow", "rgba(0, 0, 0, 0) 0px 0px 0px 0px, rgba(0, 0, 0, 0) 0px 0px 0px 0px, rgba(0, 0, 0, 0.1) 0px 4px 6px -1px, rgba(0, 0, 0, 0.1) 0px 2px 4px -2px")

            button.addEventListener('click', (event) => {
                wrapper.replaceWith(elt)

            });


/*
            let button = document.createElement("button")
            let icon = document.createElement("img");
            button.appendChild(icon)
            codeBlock.insertBefore(button, codeBlock.firstChild);

            icon.setAttribute("src", "icons/copy.svg");
            icon.setAttribute("style", "opacity: 0.5;")
            button.addEventListener('click', (event) => {
                let text = button.nextElementSibling.textContent;
                text = filterConsole(text);
                navigator.clipboard.writeText(text);
            });

            codeBlock.setAttribute("style", "position: relative");
            button.setAttribute("style", 
            "position: absolute; right: 1em; top: 1em; opacity: 0.0;");

            codeBlock.addEventListener("mouseover", (event) => {
                button.style.setProperty("transition", "opacity 0.1s ease-out");
                button.style.setProperty("opacity", "1.0");
            });

            codeBlock.addEventListener("mouseout", (event) => {
                button.style.setProperty("transition", "opacity 0.75s ease-out");
                button.style.setProperty("opacity", "0.0");
            });

            button.addEventListener("mouseover", (event) => {
                icon.style.setProperty("transition", "opacity 0.1s ease-out");
                icon.style.setProperty("opacity", "0.75");
            })

            button.addEventListener("mouseout", (event) => {
                icon.style.setProperty("transition", "opacity 0.75s ease-out");
                icon.style.setProperty("opacity", "0.5");
            })
*/

        }
    });    
</script>